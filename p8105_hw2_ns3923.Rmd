---
title: "p8105_hw2_ns3923"
Name: Nichcha Subdee (ns3923)
output: github_document
---

**Setup necessary library**
```{r setup, message=FALSE}
library(tidyverse)
```

## Problem 1
Aims: Merging *pols-month.csv*, *unemployment.csv*, and *snp.csv* into a dataframe by using year/month as keys variable

**Import data**
```{r import data, message=FALSE}
pols_df = read_csv(file = "./fivethirtyeight_datasets/pols-month.csv")
unemployment_df = read.csv(file = "./fivethirtyeight_datasets/unemployment.csv")
snp_df = read.csv(file = "./fivethirtyeight_datasets/snp.csv")
```

**Step 1**: Cleaning *pols-month.csv*

1. Break up `mon` (e.g., 1/15/1947) into integer variables `year`,`month`, and `day`

2. Replace month number with month name

3. Create `president`: taking values `gop` and `dem`

4. Remove `prez_dem` and `prez_gop`, and the day variable
```{r pols-month_dataset}
pols_df = pols_df |>
    janitor::clean_names() |>
    separate(mon, into = c("month","day","year"), convert = TRUE) |>
    mutate(
      president = ifelse(prez_gop == 1, "gop", "dem"),   
      month = factor(month, levels = 1:12, labels = month.abb, ordered = TRUE)  
           ) |>
    select(year, month, president,
           starts_with("gov"),
           starts_with("sen"),
           starts_with("rep")) |>
    arrange(year, month)
#Result
pols_df
```

**Step 2**: Cleaning *snp.csv* 

Using a similar process to pol-month.csv

```{r snp_dataset}
snp_df = snp_df |>
    janitor::clean_names() |>
    separate(date, into = c("month","day","year"), convert = TRUE) |>
    mutate(
        month = factor(month, levels = 1:12, labels = month.abb, ordered = TRUE)
      ) |>
    select(year, month, close) |>
    arrange(year, month)

#Result
head(snp_df, 10)
```

**Step 3**: Tidy *unemployment.csv* 

1. Switching from “wide” to “long” format

2. Ensuring that key variables have the same name and take the same values.

```{r unemployment_dataset}
unemployment_df = unemployment_df |>
    janitor::clean_names() |>
    pivot_longer(jan:dec, names_to = "month", values_to = "unemployment") |>
    mutate(month = factor(stringr::str_to_title(month),
           levels = month.abb, ordered = TRUE)) |>
    select(year, month, unemployment) |>
    arrange(year, month)

# show first 10 rows
head(unemployment_df, 10)
```

**Step 4**: Joining these 3 cleaned dataset

- Merging `snp` into `pols` and merging `unemployment` into the result.

```{r Final_df}
Final_df = pols_df |>
    left_join(snp_df,  by = c("year","month")) |>
    left_join(unemployment_df, by = c("year","month")) |>
    arrange(year, month)

#Result
Final_df
```



